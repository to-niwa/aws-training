## ストレージタイプの比較と選定指針（AWS）

| 種別                   | 特徴                                       | ユースケース                         | AWS サービス例                 |
| ---------------------- | ------------------------------------------ | ------------------------------------ | ------------------------------ |
| オブジェクトストレージ | 非階層・キー＋メタデータ形式で保存         | バックアップ、静的 Web、ビッグデータ | Amazon S3                      |
| ブロックストレージ     | デバイス単位のブロック単位で読み書き可能   | DB、仮想マシン、トランザクション処理 | Amazon EBS、EC2 Instance Store |
| ファイルストレージ     | POSIX 互換のファイルシステム形式で利用可能 | コンテンツ共有、ホームディレクトリ   | Amazon EFS、FSx                |

### 特徴の比較表

| 項目             | オブジェクト           | ブロック            | ファイル                   |
| ---------------- | ---------------------- | ------------------- | -------------------------- |
| データ構造       | キー・オブジェクト形式 | ブロック単位        | ファイル・ディレクトリ構造 |
| 読み書き粒度     | オブジェクト全体       | ブロック単位        | ファイル単位               |
| レイテンシ       | 高い（遅め）           | 低い（高速）        | 中程度                     |
| 更新             | 不可（再アップロード） | 可能                | 可能                       |
| アクセス方法     | REST API               | OS レベルのマウント | NFS マウントなど           |
| スケーラビリティ | 非常に高い             | 中程度              | 高い（EFS は自動拡張）     |
| 可用性           | 高（冗長性あり）       | AZ 単位（EBS）      | 高（マルチ AZ 可能）       |

## S3 ストレージクラス比較

| クラス名                      | 特徴                                | 最低保存期間      | 取り出し時間    | 主なユースケース                 |
| ----------------------------- | ----------------------------------- | ----------------- | --------------- | -------------------------------- |
| S3 Standard                   | 高頻度アクセス用、最も一般的        | なし              | 即時            | Web アプリ、動的コンテンツ       |
| S3 Intelligent-Tiering        | アクセス頻度に応じて自動階層管理    | 30 日（低頻度層） | 即時〜数分      | アクセスパターンが読めないデータ |
| S3 Standard-IA                | 低頻度アクセス（Infrequent Access） | 30 日             | 即時            | バックアップ、災害復旧用         |
| S3 One Zone-IA                | IA のゾーン冗長なし版、低コスト     | 30 日             | 即時            | 再生成可能なデータ               |
| S3 Glacier Instant Retrieval  | すぐ取り出せる Glacier（安価）      | 90 日             | 即時            | 古いが頻繁に読むログ等           |
| S3 Glacier Flexible Retrieval | 数分〜数時間で取り出し可能          | 90 日             | 数分〜12 時間   | 長期保存、低コスト               |
| S3 Glacier Deep Archive       | 最も安価、長期保管用                | 180 日            | 数時間〜12 時間 | 法令準拠アーカイブなど           |

### よく使われる標準系クラス

| クラス名                   | 特徴                                                                    |
| -------------------------- | ----------------------------------------------------------------------- |
| **S3 Standard**            | フル冗長、即時アクセス、最も汎用的。頻繁な読み書き向け                  |
| **S3 Intelligent-Tiering** | アクセス状況に応じて自動で低頻度層に移行。**自動階層化が試験頻出**      |
| **S3 Standard-IA**         | 頻度は低いが即時アクセスしたいデータに最適（安価）                      |
| **S3 One Zone-IA**         | IA と同じだが**1 つの AZ にしか保存されない**（再生成可能なデータ向き） |

### Glacier 系（アーカイブ向け）

| クラス名                       | 特徴                                                                          |
| ------------------------------ | ----------------------------------------------------------------------------- |
| **Glacier Instant Retrieval**  | 即時アクセスできるが、**読み出しに追加コスト**。アクセス頻度が月 1 回未満向き |
| **Glacier Flexible Retrieval** | 低コスト＋複数時間帯で取り出し可能（**柔軟性あり**）                          |
| **Glacier Deep Archive**       | 最も安い。アクセスはほとんどしないデータ向け（**法的保管**など）              |

### シナリオ

| シナリオ                                   | 選択すべきストレージクラス   | 理由                         |
| ------------------------------------------ | ---------------------------- | ---------------------------- |
| 頻繁にアクセスされる画像や動画             | S3 Standard                  | 高スループット・低レイテンシ |
| アクセス頻度が不明、でもコスト最適化したい | S3 Intelligent-Tiering       | 自動階層化でコスト最適化     |
| 月 1 回以下しかアクセスしないバックアップ  | S3 Standard-IA               | 安価・即時取り出し           |
| 一時保存の再生成可能なログ（高耐久不要）   | S3 One Zone-IA               | 安価・1AZ でも十分           |
| 古いログを法的に 7 年間保管したい          | S3 Glacier Deep Archive      | 最安、180 日保持前提         |
| アーカイブしたが、たまに即時アクセスあり   | S3 Glacier Instant Retrieval | 低コスト＋即時アクセス       |

## S3 マルチパートアップロード概要

### 特徴

- 大きなオブジェクトを複数のパートに分割してアップロードできる。
- 各パートは独立して並列アップロード可能。
- 最終的にすべてのパートを結合して 1 つのオブジェクトとして保存。

### メリット

- アップロードの高速化（並列アップロード）
- 中断からの再開が可能
- パート単位でのエラー処理が容易
- 5GB 以上のファイルでは推奨

### 制限と仕様

- パートのサイズ：最小 5MB（最後のパートを除く）
- 最大パート数：10,000
- 最大オブジェクトサイズ：5TB
- 使用には`InitiateMultipartUpload`, `UploadPart`, `CompleteMultipartUpload` API が必要

## EBS ボリュームタイプ比較

- 「最大性能を引き出すには何が必要か」→ io1/io2 で 64,000 IOPS 以上を出すには Nitro ベースの EC2 が必要

| ボリュームタイプ        | 特徴                                                            | 最大 IOPS   | 最大スループット | ユースケース              |
| ----------------------- | --------------------------------------------------------------- | ----------- | ---------------- | ------------------------- |
| gp3（汎用 SSD）         | コストパフォーマンス高。IOPS とスループットを**個別に設定可能** | 16,000      | 1,000 MB/s       | 一般的な Web/DB           |
| gp2（旧汎用 SSD）       | スループットと IOPS が**サイズに依存**（3 IOPS/GB）             | ～ 16,000   | ～ 250 MB/s      | 従来の標準ディスク        |
| io1（IOPS 指定 SSD）    | 高 IOPS が必要。**最大 64,000 IOPS**（Nitro 必要）              | 64,000      | 1,000 MB/s       | 大規模 DB/OLTP            |
| io2（高耐久 IOPS）      | io1 の**耐久性向上版（99.999%）**                               | 64,000      | 1,000 MB/s       | ミッションクリティカル DB |
| st1（スループット HDD） | HDD。**大容量 + 高スループット**に最適                          | ～ 500 IOPS | 500 MB/s         | ビッグデータ/ログ         |
| sc1（低コスト HDD）     | 最も安価。低頻度アクセス用途に特化                              | ～ 250 IOPS | ～ 250 MB/s      | バックアップ等            |

### シナリオ

| シナリオ                       | 正しい選択肢       | 説明                                     |
| ------------------------------ | ------------------ | ---------------------------------------- |
| RDS 用に最大 IOPS が必要       | io1 または io2     | IOPS 制御可能、耐久性も必要なら io2      |
| 安価かつ高速な一般用途         | gp3                | コスト/性能バランスが最適                |
| 低頻度アクセスのログ保存       | sc1                | 最も低コスト、頻度が低ければ最適         |
| 1TB のログデータを毎日分析     | st1                | 高スループットを求める順次 I/O に最適    |
| サイズによらず IOPS を上げたい | gp3 または io1/io2 | gp2 では IOPS はサイズ依存になるため不可 |

## AWS Snowball Edge Storage Optimized 概要

### 目的

- **大容量データの物理転送**と**エッジコンピューティング**を両立
- ネットワークが不安定 or 帯域が狭い環境でも高速にデータ移行・処理

### 特徴

- **最大 80TB 以上の有効ストレージ容量（80TB SSD）**
- EC2 インスタンス / AWS Lambda のローカル実行が可能
- データは自動暗号化（256-bit AES）
- 転送後、Snowball 経由で S3 にアップロード
- 複数台の Snowball を使って並列転送も可能

### 主なユースケース

- データセンターや拠点からの**ペタバイト級データの移行**
- ネットワークが制限された現場での**ローカル処理 + 後日 S3 連携**
- メディア、IoT、工場現場、リモートサイトでのデータ収集

### メリット

- データ移行にかかるネットワークコスト削減
- 高セキュリティ（HSM チップ + 物理ロック + 自動暗号化）
- オフライン状態でもアプリケーション処理が可能

### 関連サービス

- AWS Snowball Edge Compute Optimized（GPU/CPU 強化版）
- AWS Snowcone（軽量モデル）
- AWS DataSync（オンライン転送併用可能）
