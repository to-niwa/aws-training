## AWS CloudHSM 概要と KMS との違い

### CloudHSM とは？

- AWS が提供する**専有型ハードウェアセキュリティモジュール（HSM）**
- 暗号鍵を FIPS 140-2 Level 3 準拠デバイスで安全に保管
- **ユーザーが完全に鍵を管理**（AWS 側はアクセス不可）

### 特徴

- 専用の HSM インスタンスを VPC 内で運用
- PKCS#11、JCE、OpenSSL などの標準インターフェースで操作可能
- 暗号処理や鍵の生成・管理を**完全に自前で制御**

### KMS との主な違い

| 比較項目             | AWS KMS                              | AWS CloudHSM                              |
| -------------------- | ------------------------------------ | ----------------------------------------- |
| 鍵の管理主体         | AWS が管理（ユーザーは論理的に操作） | ユーザー自身が完全に管理                  |
| 利用形態             | マネージドサービス                   | 専用 HSM インスタンス（EC2 のように起動） |
| FIPS 認証レベル      | 140-2 Level 2                        | 140-2 Level 3                             |
| 操作インターフェース | KMS API（専用）                      | PKCS#11 / JCE / OpenSSL                   |
| 費用                 | 安価（従量課金）                     | 高額（インスタンス課金）                  |
| 使いやすさ           | 高い（数行の API で完結）            | 低め（複雑なセットアップと運用が必要）    |
| 典型ユースケース     | 一般的な鍵管理、S3 暗号化、RDS など  | 金融、政府、HSM 要件のある高度暗号業務    |

### 代表ユースケース

- CloudHSM：
  - 法規制により鍵をクラウドプロバイダに渡せない金融・政府機関
  - HSM ベースのデジタル署名、トークン発行、独自暗号処理
- KMS：
  - S3、EBS、RDS など AWS サービスとの暗号統合
  - アプリケーションレベルの鍵管理

## AWS 監査・セキュリティ監視サービス比較一覧

| サービス名          | 主な役割                                        | 監査対象                               | アラート | 代表的なユースケース                    |
| ------------------- | ----------------------------------------------- | -------------------------------------- | -------- | --------------------------------------- |
| AWS CloudTrail      | API 操作履歴の記録                              | 全 AWS サービスの API                  | ❌       | 監査ログ保管、操作追跡、証跡管理        |
| AWS Config          | 構成変更の監視とルール評価                      | リソース状態・構成                     | ✅       | 構成ドリフト検知、準拠性評価            |
| Amazon GuardDuty    | セキュリティ脅威の自動検知（ML + ルールベース） | VPC フロー、DNS、CloudTrail            | ✅       | 不審な挙動の自動検知・アラート          |
| AWS Security Hub    | セキュリティ結果の一元可視化                    | GuardDuty, Inspector 等                | ✅       | セキュリティサービス統合、スコア可視化  |
| AWS Inspector       | 脆弱性スキャン                                  | EC2, Lambda, コンテナ                  | ✅       | 自動脆弱性評価（CVE 対応）              |
| AWS Trusted Advisor | 設計のベストプラクス確認、評価                  | コスト、セキュリティ、パフォーマンス等 | ✅       | 無駄なリソースの検知、推奨構成評価      |
| Access Analyzer     | IAM ポリシーの意図しない公開検知                | S3、IAM、KMS、SNS 等                   | ✅       | IAM やリソースの外部公開検知            |
| AWS Audit Manager   | 監査レポート作成支援                            | CloudTrail, Config 等                  | ❌       | 規制対応（PCI-DSS、ISO など）の証跡管理 |

### 関係図

```
     [CloudTrail]──┐
     [Config]──────┼──→ [Security Hub] ←─ [GuardDuty]
     [Inspector]───┘                    └─ [Access Analyzer]
                                        └─ [Trusted Advisor]
                                        └─ [Audit Manager]
```
